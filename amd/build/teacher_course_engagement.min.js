define ("local_ace/teacher_course_engagement",["exports","core/ajax","core/chart_builder","core/chart_output_chartjs","local_ace/chart_filters","core/notification","core/chartjs-lazy"],function(a,b,c,d,e,f,g){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.init=void 0;b=h(b);c=h(c);d=h(d);f=h(f);g=h(g);function h(a){return a&&a.__esModule?a:{default:a}}var i=[],j=[];a.init=function init(){(0,e.init)(k);k(null,null)};var k=function(a,b){var e=r(a,b).then(function(a){if(null!==a.error||0===a.series.length){q(a.error);return null}var b=m();a.series.forEach(function(a){if(!i[a.title]){i[a.title]=parseInt(16777215*Math.random()).toString(16)}var c=l();c.label=a.title;c.values=a.values;c.colors=["#"+i[a.title]];b.series.push(c)});b.labels=a.xlabels;b.axes.y[0].max=100;b.axes.y[0].stepSize=20;var c={};a.ylabels.forEach(function(a){c[a.value]=a.label});b.axes.y[0].labels=c;return b}).catch(function(){q("API Error")});e.then(function(a){if(null===a){return}var b=document.querySelector("#chart-area-engagement"),e=b.querySelector(".chart-image");e.innerHTML="";c.default.make(a).then(function(a){new d.default(e,a);p().then(function(a){if(a.error){return}var b=a.preferences[0].value;if(null===b){return}j=b.split(",");g.default.helpers.each(g.default.instances,function(a){var b=a.chart;for(var c in b.data.datasets){var d=b.data.datasets[c];if(j.includes(d.label)){d.hidden=!0}}b.update()})}).fail(f.default.exception)}).catch()}).catch()},l=function(){return{label:"",labels:null,type:null,values:[],colors:[],fill:null,axes:{x:null,y:null},urls:[],smooth:null}},m=function(){return{type:"line",series:[],labels:[],title:"Course Engagement",axes:{x:[],y:[{label:null,labels:{},max:100,min:0,position:null,stepSize:null}]},legend_options:{display:!0,position:"right",onClick:n},config_colorset:null,smooth:!0}},n=function(a,b){var c=b.datasetIndex,d=this.chart,e=d.getDatasetMeta(c);if(null===e.hidden){if(d.data.datasets[c].hidden){j=j.filter(function(a){return a!==d.data.datasets[c].label});o();d.data.datasets[c].hidden=!1}else{j.push(d.data.datasets[c].label);o();d.data.datasets[c].hidden=!0}}d.update()},o=function(){var a={methodname:"core_user_update_user_preferences",args:{preferences:[{type:"local_ace_teacher_hidden_courses",value:j.join(",")}]}};b.default.call([a])[0].fail(f.default.exception)},p=function(){return b.default.call([{methodname:"core_user_get_user_preferences",args:{name:"local_ace_teacher_hidden_courses"}}])[0]},q=function(a){var b=document.querySelector("#chart-area-engagement"),c=b.querySelector(".chart-image");c.innerHTML=a},r=function(a,c){return b.default.call([{methodname:"local_ace_get_teacher_course_analytics_graph",args:{start:a,end:c}}])[0]}});
//# sourceMappingURL=teacher_course_engagement.min.js.map
