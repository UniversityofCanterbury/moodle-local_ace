define ("local_ace/student_engagement",["exports","core/ajax","core/str","core/chart_builder","core/chart_output_chartjs","local_ace/chart_filters"],function(a,b,c,d,e,f){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.init=void 0;b=g(b);d=g(d);e=g(e);function g(a){return a&&a.__esModule?a:{default:a}}var h,i={};a.init=function init(a){h=a.colouruserhistory;i=a.userid;(0,f.init)(j);j(null,null)};var j=function(a,b){var f=new URL(window.location.href),g=new URLSearchParams(f.search),h=null;if(g.has("course")){h=parseInt(g.get("course"))}var j=l(h,i,a,b).then(function(a){if(null!==a.error){k(a.error);return null}else if(0===a.series.length){(0,c.get_string)("noanalytics","local_ace").then(function(a){k(a)}).catch();return null}var b=m();b.series[0].values=a.series;a.comparison.forEach(function(a){var c=n();c.label=a.label;c.colors=[a.colour];c.values=a.values;c.fill=a.fill?1:null;b.series.push(c)});b.labels=a.labels;b.axes.y[0].max=a.max;b.axes.y[0].stepSize=a.stepsize;var d={};a.ylabels.forEach(function(a){d[a.value]=a.label});b.axes.y[0].labels=d;return b}).catch(function(){k("API returned an error")});j.then(function(a){if(null===a){return}var b=document.querySelector("#chart-area-engagement"),c=b.querySelector(".chart-image");c.innerHTML="";d.default.make(a).then(function(a){new e.default(c,a)}).catch()}).catch()},k=function(a){var b=document.querySelector("#chart-area-engagement"),c=b.querySelector(".chart-image");c.innerHTML=a},l=function(a,c,d,e){return b.default.call([{methodname:"local_ace_get_user_analytics_graph",args:{courseid:a,userid:c,start:d,end:e}}])[0]},m=function(){return{type:"line",series:[{label:"Your engagement",labels:null,type:null,values:null,colors:[h],fill:null,axes:{x:null,y:null},urls:[],smooth:null}],labels:null,title:null,axes:{x:[],y:[{label:null,labels:{},max:null,min:0,position:null,stepSize:null}]},legend_options:{display:!1},config_colorset:null,smooth:!0}},n=function(){return{label:"",labels:null,type:null,values:[],colors:[],fill:null,axes:{x:null,y:null},urls:[],smooth:null}}});
//# sourceMappingURL=student_engagement.min.js.map
