define("local_ace/bulk_email_all",["exports","core/modal_factory","core/templates","core/modal_events","core/str","core/ajax","core/toast","core/notification"],(function(_exports,_modal_factory,_templates,_modal_events,Str,_ajax,Toast,_notification){function _getRequireWildcardCache(nodeInterop){if("function"!=typeof WeakMap)return null;var cacheBabelInterop=new WeakMap,cacheNodeInterop=new WeakMap;return(_getRequireWildcardCache=function(nodeInterop){return nodeInterop?cacheNodeInterop:cacheBabelInterop})(nodeInterop)}function _interopRequireWildcard(obj,nodeInterop){if(!nodeInterop&&obj&&obj.__esModule)return obj;if(null===obj||"object"!=typeof obj&&"function"!=typeof obj)return{default:obj};var cache=_getRequireWildcardCache(nodeInterop);if(cache&&cache.has(obj))return cache.get(obj);var newObj={},hasPropertyDescriptor=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var key in obj)if("default"!==key&&Object.prototype.hasOwnProperty.call(obj,key)){var desc=hasPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):null;desc&&(desc.get||desc.set)?Object.defineProperty(newObj,key,desc):newObj[key]=obj[key]}return newObj.default=obj,cache&&cache.set(obj,newObj),newObj}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}
/**
   * Bulk email all students in a report
   *
   * @module      local_ace/bulk_emails_all
   * @copyright   2021 University of Canterbury
   * @license     https://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
   */Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.init=void 0,_modal_factory=_interopRequireDefault(_modal_factory),_templates=_interopRequireDefault(_templates),_modal_events=_interopRequireDefault(_modal_events),Str=_interopRequireWildcard(Str),_ajax=_interopRequireDefault(_ajax),Toast=_interopRequireWildcard(Toast),_notification=_interopRequireDefault(_notification);_exports.init=()=>{let emailSend="";Str.get_strings([{key:"emailsend",component:"local_ace"},{key:"bulkemailall",component:"local_ace"}]).then((function(langStrings){emailSend=langStrings[0];let emailSelected=langStrings[1],templatePromise=_templates.default.render("local_ace/bulk_email_selected",{});return _modal_factory.default.create({title:emailSelected,body:templatePromise,type:_modal_factory.default.types.SAVE_CANCEL})})).done((function(modal){modal.getRoot()[0].classList.add("local_ace-slim-modal"),modal.setSaveButtonText(emailSend),modal.getRoot().on(_modal_events.default.save,(function(){let tableuniqueid=document.querySelector(".tab-pane.fade.active.show .table-dynamic");null===tableuniqueid&&(tableuniqueid=document.querySelector(".table-dynamic")),tableuniqueid=tableuniqueid.getAttribute("data-table-uniqueid");let reportid=tableuniqueid.split("custom-report-table-")[1],subject=document.querySelector("#local_ace-email-subject").value,body=document.querySelector("#local_ace-email-body").value;sendBulkEmailsAll(reportid,subject,body).then((response=>{var _response$message;Toast.add(null!==(_response$message=response.message)&&void 0!==_response$message?_response$message:"An error occurred",{})}))})),modal.getRoot().on(_modal_events.default.hidden,(function(){modal.destroy()})),modal.show()})).catch(_notification.default.exception)};const sendBulkEmailsAll=(reportid,subject,body)=>_ajax.default.call([{methodname:"local_ace_send_bulk_emails_all",args:{reportid:reportid,subject:subject,body:body}}])[0]}));

//# sourceMappingURL=bulk_email_all.min.js.map